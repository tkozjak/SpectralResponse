import Qt3D.Core 2.13
import Qt3D.Render 2.13
import Qt3D.Extras 2.13

import QtQuick 2.13 as QQ2

Entity{

    Buffer{
        id: vertex_buffer
        type: Buffer.VertexBuffer
        data: {
            var buffer = new Float32Array(89*3);

            var shortResponses = [ 0.010814339512979,
                                  0.026644035277249,
                                  0.0625604695964,
                                  0.133567254789169,
                                  0.251072993137352,
                                  0.405975663251568,
                                  0.571873536506665,
                                  0.701132340686736,
                                  0.824517732043984,
                                  0.917698453849781,
                                  0.994947121750992,
                                  0.984237708779116,
                                  0.937993869618489,
                                  0.835218297412601,
                                  0.755614007093093,
                                  0.701455298419971,
                                  0.607575146105741,
                                  0.480286080239691,
                                  0.359252666247662,
                                  0.264423469921159,
                                  0.191029306916366,
                                  0.143251771069375,
                                  0.108542544930683,
                                  0.077767833445571,
                                  0.052686578969737,
                                  0.036728230049809,
                                  0.024808471080889,
                                  0.016319242651056,
                                  0.010502676773407,
                                  0.006683439175686,
                                  0.004162938547861,
                                  0.002568620829383,
                                  0.00157362048324,
                                  0.000957414498751,
                                  0.000583982724619,
                                  0.000356533218783,
                                  0.000218423820914,
                                  0.000134493098769,
                                  0.000083368118462,
                                  0.00005210747154,
                                  0.000032870022397,
                                  0.000020955595172,
                                  0.000013508278317,
                                  0.00000881048873,
                                  0.00000581969199,
                                  0.000003892243482,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0,
                                  0];

            var mediumResponses = [ 0.000511917528,
                                   0.00131552770877,
                                   0.003076096814741,
                                   0.006290714855478,
                                   0.01162518840328,
                                   0.018975795877209,
                                   0.027957607275808,
                                   0.03771377450114,
                                   0.049739337910678,
                                   0.064565422903466,
                                   0.079799468726798,
                                   0.092427243273012,
                                   0.104857620938077,
                                   0.116976870921149,
                                   0.137025059712424,
                                   0.168500036778183,
                                   0.202861671696629,
                                   0.234368909882699,
                                   0.266256365851297,
                                   0.2995711592428,
                                   0.335892262734495,
                                   0.391020926126814,
                                   0.463767168124062,
                                   0.553477537457161,
                                   0.654184123569238,
                                   0.757007182299965,
                                   0.851334042543229,
                                   0.914323748057098,
                                   0.956973694587658,
                                   0.981521913225757,
                                   0.999079389984462,
                                   0.991744955231413,
                                   0.96316346402398,
                                   0.934329368257314,
                                   0.888382510403021,
                                   0.837722152575058,
                                   0.773570678774939,
                                   0.697910930199934,
                                   0.610520146834102,
                                   0.530517848880897,
                                   0.45258483736866,
                                   0.37462779834406,
                                   0.30213427798433,
                                   0.23730123584905,
                                   0.182389570231964,
                                   0.137720946889395,
                                   0.101976476004472,
                                   0.074233510703662,
                                   0.053444128557439,
                                   0.037975193897133,
                                   0.026619506511518,
                                   0.018323144223712,
                                   0.012882495516931,
                                   0.008865433979892,
                                   0.005997910762555,
                                   0.004052285168019,
                                   0.002780353394087,
                                   0.001908095028528,
                                   0.001305268928809,
                                   0.000887360310779,
                                   0.000597860691352,
                                   0.000409826464981,
                                   0.000282878538797,
                                   0.000194849815992,
                                   0.000133137378083,
                                   0.000091432374806,
                                   0.000063372377416,
                                   0.000044065631669,
                                   0.000030895839476,
                                   0.000021707009684,
                                   0.000015300301891,
                                   0.000010947123056,
                                   0.000007819878404,
                                   0.000005616942784,
                                   0.000004058821947,
                                   0.000002933593941,
                                   0.000002130590568,
                                   0.000001546322232,
                                   0.000001135795124,
                                   0.000000835987916,
                                   0.000000617021078,
                                   0.00000045656225,
                                   0.000000340957305,
                                   0.000000255917509,
                                   0.000000191601983,
                                   0.000000144244745,
                                   0.000000109169168,
                                   0.000000082470761,
                                   0.000000062258693 ];

            var longResponses = [ 0.000604505142865,
                                 0.001512864388193,
                                 0.003419794425137,
                                 0.006779536449242,
                                 0.012083701820269,
                                 0.018318925649538,
                                 0.024951691947416,
                                 0.0306478490537,
                                 0.037239170625457,
                                 0.044534850626986,
                                 0.051975658465836,
                                 0.057358792484213,
                                 0.06295061828572,
                                 0.06908758310498,
                                 0.07990979195811,
                                 0.098582539171,
                                 0.120226443461741,
                                 0.142069221286018,
                                 0.165844090127756,
                                 0.192043671394335,
                                 0.222075168345075,
                                 0.267300640866331,
                                 0.328322011609199,
                                 0.404669059465087,
                                 0.494196880847838,
                                 0.591697861958719,
                                 0.68659399383665,
                                 0.762430041200757,
                                 0.826037949577179,
                                 0.876798907488965,
                                 0.926829823379349,
                                 0.957855505959883,
                                 0.970957006528824,
                                 0.988553094656939,
                                 0.995634644308791,
                                 0.999769767998157,
                                 0.996552080134768,
                                 0.980392544604421,
                                 0.949510999202198,
                                 0.927897490127331,
                                 0.893099816223518,
                                 0.845862944818425,
                                 0.789587019336695,
                                 0.727779804536824,
                                 0.65720370028709,
                                 0.582639601623575,
                                 0.507808539664889,
                                 0.436214401908049,
                                 0.361326654523452,
                                 0.293291853400844,
                                 0.235884823562898,
                                 0.187845155867413,
                                 0.144311187366504,
                                 0.108193208472766,
                                 0.080057126893536,
                                 0.058519418237808,
                                 0.042276594851624,
                                 0.030143938842795,
                                 0.021203131167399,
                                 0.014696028989797,
                                 0.01001843765724,
                                 0.006924684643226,
                                 0.004786300923226,
                                 0.003296856163569,
                                 0.002243881923783,
                                 0.001525808394807,
                                 0.001046887465549,
                                 0.000719117735783,
                                 0.000497507921351,
                                 0.000344746606573,
                                 0.000238616241088,
                                 0.00016722453616,
                                 0.000117057703596,
                                 0.000082394837204,
                                 0.000058290797887,
                                 0.000041304750199,
                                 0.000029457779023,
                                 0.00002097490488,
                                 0.000015097324854,
                                 0.000010886793868,
                                 0.000007870457897,
                                 0.000005700330022,
                                 0.000004154320512,
                                 0.000003042285727,
                                 0.000002223309891,
                                 0.00000163418041,
                                 0.000001210040761,
                                 0.000000896809087,
                                 0.000000666806769 ];


            for(var i = 0; i < buffer.length; i+=3){
                buffer[i+2] = parseFloat(longResponses[i/3]);
                buffer[i+1] = parseFloat(shortResponses[i/3]);
                buffer[i+0] = parseFloat(mediumResponses[i/3]);
            }


            return buffer;
        }
    }

    GeometryRenderer{
        id: geometry_renderer
        instanceCount: 1
        indexOffset: 0
        firstInstance: 0

        primitiveType: GeometryRenderer.LineStrip

        geometry: Geometry{
            boundingVolumePositionAttribute: vertex_position
            Attribute{
                id: vertex_position
                attributeType: Attribute.VertexAttribute
                vertexBaseType: Attribute.Float

                vertexSize: 3
                byteOffset: 0
                byteStride: 3*4
                count: 89
                name: typeof defaultPositionAttributeName === "function" ?
                          defaultPositionAttributeName():
                          defaultPositionAttributeName // FIXME: Qt5.8 ???
                buffer: vertex_buffer
            }
        }
    }

    Transform {
        id: transform_spectralLocus
        translation: Qt.vector3d( 0.0, 0.0, 0.0 )
        scale3D: Qt.vector3d( 10.0, 10.0, 10.0 )
        rotation: fromAxisAndAngle( Qt.vector3d(0, 1, 0), 0.0 )
    }

    PhongMaterial{
        id: phongTempMaterial
        diffuse: "red"
        specular: "black"
    }

    Entity{
        components: [geometry_renderer, transform_spectralLocus, phongTempMaterial ]
    }
}
